from copy import deepcopy

import numpy as np
import pytest

from ssms.dataset_generators.lan_mlp import data_generator
from ssms.config import model_config, data_generator_config

gen_config = data_generator_config["lan"]
# Specify number of parameter sets to simulate
gen_config["n_parameter_sets"] = 100
# Specify how many samples a simulation run should entail
gen_config["n_samples"] = 1000

# angle


expected_shapes = {
    "ddm_mic2_adj": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "ddm_mic2_adj_angle_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "ddm_mic2_adj_conflict_gamma_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "ddm_mic2_adj_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "ddm_mic2_adj_weibull_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ddm_mic2_leak": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "ddm_mic2_leak_angle_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "ddm_mic2_leak_angle_no_bias_no_lowdim_noise": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "ddm_mic2_leak_conflict_gamma_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "ddm_mic2_leak_conflict_gamma_no_bias_no_lowdim_noise": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "ddm_mic2_leak_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "ddm_mic2_leak_no_bias_no_lowdim_noise": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "ddm_mic2_leak_weibull_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ddm_mic2_leak_weibull_no_bias_no_lowdim_noise": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ddm_mic2_multinoise_angle_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "ddm_mic2_multinoise_conflict_gamma_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "ddm_mic2_multinoise_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "ddm_mic2_multinoise_weibull_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ddm_mic2_ornstein": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "ddm_mic2_ornstein_angle_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ddm_mic2_ornstein_angle_no_bias_no_lowdim_noise": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ddm_mic2_ornstein_conflict_gamma_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 11),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 11),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 11),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 13),
        "lan_labels": (100000,),
        "opn_data": (100, 11),
        "opn_labels": (100, 1),
        "thetas": (100, 11),
    },
    "ddm_mic2_ornstein_conflict_gamma_no_bias_no_lowdim_noise": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 11),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 11),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 11),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 13),
        "lan_labels": (100000,),
        "opn_data": (100, 11),
        "opn_labels": (100, 1),
        "thetas": (100, 11),
    },
    "ddm_mic2_ornstein_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "ddm_mic2_ornstein_no_bias_no_lowdim_noise": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "ddm_mic2_ornstein_weibull_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "ddm_mic2_ornstein_weibull_no_bias_no_lowdim_noise": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "ddm_par2": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ddm_par2_angle_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "ddm_par2_conflict_gamma_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "ddm_par2_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 5),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "thetas": (100, 5),
    },
    "ddm_par2_weibull_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "ddm_seq2": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ddm_seq2_angle_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "ddm_seq2_conflict_gamma_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "ddm_seq2_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 5),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "thetas": (100, 5),
    },
    "ddm_seq2_weibull_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "dev_rlwm_lba_pw_v1": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "dev_rlwm_lba_race_v1": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "ds_conflict_drift": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 10),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "ds_conflict_drift_angle": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 11),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 11),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 11),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 13),
        "lan_labels": (100000,),
        "opn_data": (100, 11),
        "opn_labels": (100, 1),
        "thetas": (100, 11),
    },
    "full_ddm2": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 7),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "gamma_drift_angle": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 8),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "lba2": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 4),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 4),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 4),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 6),
        "lan_labels": (100000,),
        "opn_data": (100, 4),
        "opn_labels": (100, 1),
        "thetas": (100, 4),
    },
    "lba3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 5),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "thetas": (100, 5),
    },
    "lba_angle_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "lca_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "lca_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 12),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 12),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 12),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 14),
        "lan_labels": (100000,),
        "opn_data": (100, 12),
        "opn_labels": (100, 1),
        "thetas": (100, 12),
    },
    "lca_no_bias_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "lca_no_bias_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "lca_no_bias_angle_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "lca_no_bias_angle_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "lca_no_z_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "lca_no_z_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "lca_no_z_angle_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "lca_no_z_angle_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 9),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 9),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 9),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 11),
        "lan_labels": (100000,),
        "opn_data": (100, 9),
        "opn_labels": (100, 1),
        "thetas": (100, 9),
    },
    "ornstein": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 5),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "thetas": (100, 5),
    },
    "ornstein_angle": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 6),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "race_2": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 6),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "race_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "race_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "race_no_bias_2": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 5),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "thetas": (100, 5),
    },
    "race_no_bias_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "race_no_bias_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "race_no_bias_angle_2": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 6),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "race_no_bias_angle_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "race_no_bias_angle_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "race_no_z_2": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 4),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 4),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 4),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 6),
        "lan_labels": (100000,),
        "opn_data": (100, 4),
        "opn_labels": (100, 1),
        "thetas": (100, 4),
    },
    "race_no_z_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 5),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "thetas": (100, 5),
    },
    "race_no_z_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "race_no_z_angle_2": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 5),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "thetas": (100, 5),
    },
    "race_no_z_angle_3": {
        "binned_128": (100, 128, 3),
        "binned_256": (100, 256, 3),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 3),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 3),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "race_no_z_angle_4": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "shrink_spot_extended": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 8),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "shrink_spot_simple": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 7),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "shrink_spot_simple_extended": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 7),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "tradeoff_angle_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 7),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "thetas": (100, 7),
    },
    "tradeoff_conflict_gamma_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 10),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 10),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 10),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 12),
        "lan_labels": (100000,),
        "opn_data": (100, 10),
        "opn_labels": (100, 1),
        "thetas": (100, 10),
    },
    "tradeoff_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 6),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "tradeoff_weibull_no_bias": {
        "binned_128": (100, 128, 4),
        "binned_256": (100, 256, 4),
        "cpn_data": (100, 8),
        "cpn_labels": (100, 4),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100, 4),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "thetas": (100, 8),
    },
    "weibull_cdf": {
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
        "cpn_data": (100, 6),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100,),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "thetas": (100, 6),
    },
    "shrink_spot": {
        "cpn_data": (100, 8),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 8),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 8),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 8),
        "gonogo_labels": (100, 1),
        "thetas": (100, 8),
        "lan_data": (100000, 10),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "gamma_drift": {
        "cpn_data": (100, 7),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "thetas": (100, 7),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "ddm_sdv": {
        "cpn_data": (100, 5),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "thetas": (100, 5),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "ddm_rayleight": {
        "cpn_data": (100, 4),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 4),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 4),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 4),
        "gonogo_labels": (100, 1),
        "thetas": (100, 4),
        "lan_data": (100000, 6),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "ddm_truncnormt": {
        "cpn_data": (100, 5),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "thetas": (100, 5),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "ddm_st": {
        "cpn_data": (100, 5),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "thetas": (100, 5),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "full_ddm_rv": {
        "cpn_data": (100, 7),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "thetas": (100, 7),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "ddm_legacy": {
        "cpn_data": (100, 4),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 4),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 4),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 4),
        "gonogo_labels": (100, 1),
        "thetas": (100, 4),
        "lan_data": (100000, 6),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "angle": {
        "cpn_data": (100, 5),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "thetas": (100, 5),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "ddm": {
        "cpn_data": (100, 4),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 4),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 4),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 4),
        "gonogo_labels": (100, 1),
        "thetas": (100, 4),
        "lan_data": (100000, 6),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "weibull": {
        "cpn_data": (100, 6),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "thetas": (100, 6),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "levy": {
        "cpn_data": (100, 5),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 5),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 5),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 5),
        "gonogo_labels": (100, 1),
        "thetas": (100, 5),
        "lan_data": (100000, 7),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "levy_angle": {
        "cpn_data": (100, 6),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 6),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 6),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 6),
        "gonogo_labels": (100, 1),
        "thetas": (100, 6),
        "lan_data": (100000, 8),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
    "full_ddm": {
        "cpn_data": (100, 7),
        "cpn_labels": (100,),
        "cpn_no_omission_data": (100, 7),
        "cpn_no_omission_labels": (100,),
        "opn_data": (100, 7),
        "opn_labels": (100, 1),
        "gonogo_data": (100, 7),
        "gonogo_labels": (100, 1),
        "thetas": (100, 7),
        "lan_data": (100000, 9),
        "lan_labels": (100000,),
        "binned_128": (100, 128, 2),
        "binned_256": (100, 256, 2),
    },
}

add_to_expected_shapes = {}
add_to_expected_constrained_param_space = {}

expected_constrained_param_space = {
    "shrink_spot_extended": {
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "ptarget": (2.0, 5.5),
        "pouter": (-5.5, 5.5),
        "pinner": (-5.5, 5.5),
        "r": (0.01, 1.0),
        "sda": (1, 3),
    },
    "shrink_spot_simple": {
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "ptarget": (2.0, 5.5),
        "pouter": (-5.5, 5.5),
        "r": (0.01, 0.05),
        "sda": (1, 3),
    },
    "shrink_spot_simple_extended": {
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "ptarget": (2.0, 5.5),
        "pouter": (-5.5, 5.5),
        "r": (0.01, 1.0),
        "sda": (1, 3),
    },
    "gamma_drift_angle": {
        "v": (-3.0, 3.0),
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "theta": (-0.1, 1.3),
        "shape": (2.0, 10.0),
        "scale": (0.01, 1.0),
        "c": (-3.0, 3.0),
    },
    "ds_conflict_drift": {
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "tinit": (0.0, 5.0),
        "dinit": (0.0, 5.0),
        "tslope": (0.01, 5.0),
        "dslope": (0.01, 5.0),
        "tfixedp": (0.0, 5.0),
        "tcoh": (-1.0, 1.0),
        "dcoh": (-1.0, 1.0),
    },
    "ds_conflict_drift_angle": {
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "tinit": (0.0, 5.0),
        "dinit": (0.0, 5.0),
        "tslope": (0.01, 5.0),
        "dslope": (0.01, 5.0),
        "tfixedp": (0.0, 5.0),
        "tcoh": (-1.0, 1.0),
        "dcoh": (-1.0, 1.0),
        "theta": (0.0, 1.3),
    },
    "ornstein": {
        "v": (-2.0, 2.0),
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "g": (-1.0, 1.0),
        "t": (0.001, 2),
    },
    "ornstein_angle": {
        "v": (-2.0, 2.0),
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "g": (-1.0, 1.0),
        "t": (0.001, 2),
        "theta": (-0.1, 1.3),
    },
    "lba2": {"A": (0.0, 1.0), "b": (0.0, 1.0), "v0": (0.0, 1.0), "v1": (0.1, 1.1)},
    "lba3": {
        "A": (0.0, 1.0),
        "b": (0.0, 1.0),
        "v0": (0.0, 1.0),
        "v1": (0.1, 1.1),
        "v2": (0.1, 0.5),
    },
    "lba_angle_3": {
        "v0": (0.0, 6.0),
        "v1": (0.0, 6.0),
        "v2": (0.0, 6.0),
        "a": (0.1, 1.1),
        "z": (0.0, 0.5),
        "theta": (0, 1.3),
    },
    "dev_rlwm_lba_pw_v1": {
        "v_RL_0": (0.0, 1.0),
        "v_RL_1": (0.0, 1.0),
        "v_RL_2": (0.0, 1.0),
        "v_WM_0": (0.0, 1.0),
        "v_WM_1": (0.0, 1.0),
        "v_WM_2": (0.0, 1.0),
        "a": (0.05, 1.1),
        "z": (0.0, 0.5),
        "t_WM": (0.01, 0.5),
    },
    "dev_rlwm_lba_race_v1": {
        "v_RL_0": (0.0, 1.0),
        "v_RL_1": (0.0, 1.0),
        "v_RL_2": (0.0, 1.0),
        "v_WM_0": (0.0, 1.0),
        "v_WM_1": (0.0, 1.0),
        "v_WM_2": (0.0, 1.0),
        "a": (0.05, 1.1),
        "z": (0.0, 0.5),
    },
    "race_2": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z0": (0.0, 0.9),
        "z1": (0.0, 0.9),
        "t": (0.0, 2.0),
    },
    "race_no_bias_2": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "t": (0.0, 2.0),
    },
    "race_no_z_2": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "a": (1.0, 3.0),
        "t": (0.0, 2.0),
    },
    "race_no_bias_angle_2": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.45),
    },
    "race_no_z_angle_2": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "a": (1.0, 3.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.45),
    },
    "race_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z0": (0.0, 0.9),
        "z1": (0.0, 0.9),
        "z2": (0.0, 0.9),
        "t": (0.0, 2.0),
    },
    "race_no_bias_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "t": (0.0, 2.0),
    },
    "race_no_z_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "t": (0.0, 2.0),
    },
    "race_no_bias_angle_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.45),
    },
    "race_no_z_angle_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.45),
    },
    "race_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z0": (0.0, 0.9),
        "z1": (0.0, 0.9),
        "z2": (0.0, 0.9),
        "z3": (0.0, 0.9),
        "t": (0.0, 2.0),
    },
    "race_no_bias_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "t": (0.0, 2.0),
    },
    "race_no_z_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "t": (0.0, 2.0),
    },
    "race_no_bias_angle_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.45),
    },
    "race_no_z_angle_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.45),
    },
    "lca_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z0": (0.0, 0.9),
        "z1": (0.0, 0.9),
        "z2": (0.0, 0.9),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
    },
    "lca_no_bias_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
    },
    "lca_no_z_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
    },
    "lca_no_bias_angle_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-1.0, 1.45),
    },
    "lca_no_z_angle_3": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "a": (1.0, 3.0),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-1.0, 1.45),
    },
    "lca_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z0": (0.0, 0.9),
        "z1": (0.0, 0.9),
        "z2": (0.0, 0.9),
        "z3": (0.0, 0.9),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
    },
    "lca_no_bias_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
    },
    "lca_no_z_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
    },
    "lca_no_bias_angle_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "z": (0.0, 0.9),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.45),
    },
    "lca_no_z_angle_4": {
        "v0": (0.0, 2.5),
        "v1": (0.0, 2.5),
        "v2": (0.0, 2.5),
        "v3": (0.0, 2.5),
        "a": (1.0, 3.0),
        "g": (-1.0, 1.0),
        "b": (-1.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.45),
    },
    "ddm_par2": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "zh": (0.2, 0.8),
        "zl1": (0.2, 0.8),
        "zl2": (0.2, 0.8),
        "t": (0.0, 2.0),
    },
    "ddm_par2_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "t": (0.0, 2.0),
    },
    "ddm_par2_conflict_gamma_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alpha_gamma": (1.1, 5.0),
        "scale_gamma": (0.5, 5.0),
    },
    "ddm_par2_angle_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "ddm_par2_weibull_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "ddm_seq2": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "zh": (0.2, 0.8),
        "zl1": (0.2, 0.8),
        "zl2": (0.2, 0.8),
        "t": (0.0, 2.0),
    },
    "ddm_seq2_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "t": (0.0, 2.0),
    },
    "ddm_seq2_conflict_gamma_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alpha_gamma": (1.1, 5.0),
        "scale_gamma": (0.5, 5.0),
    },
    "ddm_seq2_angle_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "ddm_seq2_weibull_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "ddm_mic2_adj": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "zh": (0.2, 0.8),
        "zl1": (0.2, 0.8),
        "zl2": (0.2, 0.8),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_adj_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_adj_conflict_gamma_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alpha_gamma": (1.1, 5.0),
        "scale_gamma": (0.5, 5.0),
    },
    "ddm_mic2_adj_angle_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "ddm_mic2_adj_weibull_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "ddm_mic2_ornstein": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "zh": (0.2, 0.8),
        "zl1": (0.2, 0.8),
        "zl2": (0.2, 0.8),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_ornstein_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_ornstein_conflict_gamma_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alpha_gamma": (1.1, 5.0),
        "scale_gamma": (0.5, 5.0),
    },
    "ddm_mic2_ornstein_angle_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "ddm_mic2_ornstein_weibull_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "ddm_mic2_multinoise_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_multinoise_conflict_gamma_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alpha_gamma": (1.1, 5.0),
        "scale_gamma": (0.5, 5.0),
    },
    "ddm_mic2_multinoise_angle_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "ddm_mic2_multinoise_weibull_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "ddm_mic2_leak": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "zh": (0.2, 0.8),
        "zl1": (0.2, 0.8),
        "zl2": (0.2, 0.8),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_leak_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_leak_conflict_gamma_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alpha_gamma": (1.1, 5.0),
        "scale_gamma": (0.5, 5.0),
    },
    "ddm_mic2_leak_angle_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "ddm_mic2_leak_weibull_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "tradeoff_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
    },
    "tradeoff_angle_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "tradeoff_weibull_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "tradeoff_conflict_gamma_no_bias": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alphagamma": (1.1, 5.0),
        "scalegamma": (0.5, 5.0),
    },
    "weibull_cdf": {
        "v": (-2.5, 2.5),
        "a": (0.3, 2.5),
        "z": (0.2, 0.8),
        "t": (0.001, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "full_ddm2": {
        "v": (-3.0, 3.0),
        "a": (0.3, 2.5),
        "z": (0.3, 0.7),
        "t": (0.25, 2.25),
        "sz": (0.001, 0.2),
        "sv": (0.001, 2.0),
        "st": (0.001, 0.25),
    },
    "ddm_mic2_ornstein_no_bias_no_lowdim_noise": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_ornstein_angle_no_bias_no_lowdim_noise": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "ddm_mic2_ornstein_weibull_no_bias_no_lowdim_noise": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "ddm_mic2_ornstein_conflict_gamma_no_bias_no_lowdim_noise": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "d": (0.0, 1.0),
        "g": (0.0, 3.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alpha_gamma": (1.1, 5.0),
        "scale_gamma": (0.5, 5.0),
    },
    "ddm_mic2_leak_no_bias_no_lowdim_noise": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
    },
    "ddm_mic2_leak_angle_no_bias_no_lowdim_noise": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "theta": (-0.1, 1.0),
    },
    "ddm_mic2_leak_weibull_no_bias_no_lowdim_noise": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "a": (0.3, 2.5),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "ddm_mic2_leak_conflict_gamma_no_bias_no_lowdim_noise": {
        "vh": (-4.0, 4.0),
        "vl1": (-4.0, 4.0),
        "vl2": (-4.0, 4.0),
        "d": (0.0, 1.0),
        "t": (0.0, 2.0),
        "a": (0.3, 2.5),
        "theta": (0.0, 0.5),
        "scale": (0.0, 5.0),
        "alpha_gamma": (1.1, 5.0),
        "scale_gamma": (0.5, 5.0),
    },
    "shrink_spot": {
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "ptarget": (2.0, 5.5),
        "pouter": (-5.5, 5.5),
        "pinner": (-5.5, 5.5),
        "r": (0.01, 0.05),
        "sda": (1, 3),
    },
    "gamma_drift": {
        "v": (-3.0, 3.0),
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "shape": (2.0, 10.0),
        "scale": (0.01, 1.0),
        "c": (-3.0, 3.0),
    },
    "ddm_sdv": {
        "v": (-3.0, 3.0),
        "a": (0.3, 2.5),
        "z": (0.1, 0.9),
        "t": (0.001, 2.0),
        "sv": (0.001, 2.5),
    },
    "ddm_rayleight": {
        "v": (-3.0, 3.0),
        "a": (0.3, 2.5),
        "z": (0.3, 0.7),
        "st": (0.001, 1.0),
    },
    "ddm_truncnormt": {
        "v": (-3.0, 3.0),
        "a": (0.3, 2.5),
        "z": (0.3, 0.7),
        "mt": (0.05, 2.25),
        "st": (0.001, 0.5),
    },
    "ddm_st": {
        "v": (-3.0, 3.0),
        "a": (0.3, 2.5),
        "z": (0.3, 0.7),
        "t": (0.25, 2.25),
        "st": (0.001, 0.25),
    },
    "full_ddm_rv": {
        "v": (-3.0, 3.0),
        "a": (0.3, 2.5),
        "z": (0.3, 0.7),
        "t": (0.25, 2.25),
        "sz": (0.001, 0.2),
        "sv": (0.001, 2.0),
        "st": (0.001, "t"),
    },
    "levy_angle": {
        "v": (-3.0, 3.0),
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "alpha": (1.0, 2.0),
        "t": (0.001, 2),
        "theta": (-0.1, 1.3),
    },
    "angle": {
        "a": (0.3, 3.0),
        "t": (0.001, 2.0),
        "theta": (-0.1, 1.3),
        "v": (-3.0, 3.0),
        "z": (0.1, 0.9),
    },
    "ddm": {"v": (-3.0, 3.0), "a": (0.3, 2.5), "z": (0.1, 0.9), "t": (0.0, 2.0)},
    "ddm_legacy": {"v": (-3.0, 3.0), "a": (0.3, 2.5), "z": (0.1, 0.9), "t": (0.0, 2.0)},
    "weibull": {
        "v": (-2.5, 2.5),
        "a": (0.3, 2.5),
        "z": (0.2, 0.8),
        "t": (0.001, 2.0),
        "alpha": (0.31, 4.99),
        "beta": (0.31, 6.99),
    },
    "levy": {
        "v": (-3.0, 3.0),
        "a": (0.3, 3.0),
        "z": (0.1, 0.9),
        "alpha": (1.0, 2.0),
        "t": (0.001, 2),
    },
    "full_ddm": {
        "v": (-3.0, 3.0),
        "a": (0.3, 2.5),
        "z": (0.3, 0.7),
        "t": (0.25, 2.25),
        "sz": (0.001, 0.2),
        "sv": (0.001, 2.0),
        "st": (0.001, 0.25),
    },
}


@pytest.mark.parametrize("model_name", list(model_config.keys())[25:])
def test_model_config(model_name):
    # Take an example config for a given model
    model_conf = model_config[model_name]

    assert type(model_conf["simulator"]).__name__ == "cython_function_or_method"

    assert callable(model_conf["simulator"])
    assert callable(model_conf["boundary"])


# @pytest
# @pytest.mark.parametrize("model_name", model_config.keys())
# def test_data_generator(tmp_path, model_name):
def test_data_generator(tmp_path):
    models_to_skip = [
        "lba_3_vs_constraint",
        "lba_angle_3_vs_constraint",
        "dev_rlwm_lba_race_v2",
    ]
    for model_name in model_config:
        if model_name in models_to_skip:
            print(f"Skipping {model_name}...")
            continue
        # print(f"**** Testing {model_name}... ****")
        # Initialize the generator config (for MLP LANs)

        generator_config = deepcopy(gen_config)
        # Specify generative model (one from the list of included models mentioned above)

        generator_config["dgp_list"] = model_name

        # set output folder
        generator_config["output_folder"] = str(tmp_path)

        # Now let's define our corresponding `model_config`.
        model_conf = model_config[model_name]

        with pytest.raises(ValueError):
            data_generator(generator_config=generator_config, model_config=None)

        with pytest.raises(ValueError):
            data_generator(generator_config=None, model_config=model_conf)

        my_dataset_generator = data_generator(
            generator_config=generator_config, model_config=model_conf
        )
        training_data = my_dataset_generator.generate_data_training_uniform(save=True)

        new_data_file = list(tmp_path.iterdir())[0]
        assert new_data_file.exists()
        assert new_data_file.suffix == ".dill"

        # Because randomly generated arrays may differ across OS and versions of Python,
        # even when setting a random seed, we check for array shape
        td_array_shapes = {
            k: v.shape for k, v in training_data.items() if isinstance(v, np.ndarray)
        }

        # shapes = {model_name: td_array_shapes}
        # space = {model_name: training_data["model_config"]["constrained_param_space"]}
        # if model_name not in expected_shapes:
        #     add_to_expected_shapes[model_name] = shapes[model_name]
        #     add_to_expected_constrained_param_space[model_name] = space[model_name]
        assert td_array_shapes == expected_shapes[model_name]

        assert list(training_data.keys()) == [
            "cpn_data",
            "cpn_labels",
            "cpn_no_omission_data",
            "cpn_no_omission_labels",
            "opn_data",
            "opn_labels",
            "gonogo_data",
            "gonogo_labels",
            "thetas",
            "lan_data",
            "lan_labels",
            "binned_128",
            "binned_256",
            "generator_config",
            "model_config",
        ]
    # breakpoint()

    assert (
        training_data["model_config"]["constrained_param_space"]
        == expected_constrained_param_space[model_name]
    )

    del training_data["model_config"]["constrained_param_space"]
    sfp = "simulator_fixed_params"
    if (
        sfp in training_data["model_config"] and model_name in model_config
    ):  # can't compare these
        del training_data["model_config"][sfp]
        del model_config[model_name][sfp]
    assert training_data["model_config"] == model_config[model_name]
